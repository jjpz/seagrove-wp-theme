jQuery(document).ready((function(e){var a,t=[];google.maps.event.addDomListener(window,"load",(function(){if("undefined"!=typeof locations&&""!==locations){a=new google.maps.Map(document.getElementById("map"),{gestureHandling:"auto",zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1});var i=new google.maps.InfoWindow,o=new google.maps.LatLngBounds;function l(){!function(){for(var e=0;e<t.length;e++)t[e].setMap(null)}(),t=[]}function s(e){var l=e.length;if(o=new google.maps.LatLngBounds(null),l<1){var s=25.761681,r=-80.191788,c=new google.maps.LatLng(s,r);o.extend(c)}else for(var p=0;p<l;p++){if(s=e[p].lat,r=e[p].lng,c=new google.maps.LatLng(s,r),"logo"===e[p].marker_type)var d={url:e[p].marker,scaledSize:new google.maps.Size(40,53)};else d={url:e[p].marker,scaledSize:new google.maps.Size(27,35),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,35)};o.extend(c);var m=new google.maps.Marker({position:c,icon:d,map:a});t.push(m),n(e[p],m,i)}return a.setCenter(o.getCenter()),l<1?a.setZoom(10):l>1?(a.fitBounds(o),a.panToBounds(o)):a.setZoom(15),console.log(t),t}function n(t,i,o){google.maps.event.addListener(i,"click",(function(l){var s='<div class="infowindow" data-index="'+t.index+'">';s+='<div class="property-card">',s+='<div class="content">',t.image.length>0&&(s+='<div class="image"><div class="thumbnail"><img src="'+t.image+'"></div></div>'),s+='<div class="info">',s+='<div class="title"><h6>'+t.title+"</h6></div>",s+='<div class="address"><span>'+t.street_number+"</span></div>",s+='<div class="details">',""!=t.bed&&0!=t.bed&&(s+='<span class="meta bed">&bull; '+t.bed+" bed</span>"),""!=t.bath&&0!=t.bath&&(s+='<span class="meta bath">&bull; '+t.bath+" bath</span>"),""!=t.size&&0!=t.size&&(s+='<span class="meta size">&bull; '+t.size+" sqft</span>"),""!=t.lot&&0!=t.lot&&(s+='<span class="meta lot">&bull; '+t.lot+" sqft lot</span>"),""!=t.price&&0!=t.price&&(s+='<span class="meta price">&bull; $'+t.price+"</span>"),s+="</div>",s+="</div>",s+="</div>",s+='<div class="buttons"><a href="'+t.url+'">View Details</a></div>',s+="</div>",s+="</div>",o.index=t.index,o.setOptions({content:s,maxWidth:300}),o.open(a,i),e(".list-item").removeClass("active"),e(".list-item-"+o.index).addClass("active")}))}s(locations),new markerClusterer.MarkerClusterer({map:a,markers:t}),e(document).on("click","#marker-link",(function(i){i.preventDefault();var o=e(i.currentTarget),l=t[o.data("marker-id")],s=l.getPosition();e(".list-item").removeClass("active"),e(".list-item-"+o.data("marker-id")).addClass("active"),e(".map-list").removeClass("open"),e(".map-list-controls .show-list").removeClass("active"),e(".map-list-controls .show-map").addClass("active"),google.maps.event.trigger(l,"click"),a.panTo(s)})),google.maps.event.addListener(i,"closeclick",(function(){e(".list-item-"+i.index).removeClass("active")})),""!==e("#search").val()&&e("#search-reset").addClass("open"),e(document).on("click","#search-reset",(function(a){a.preventDefault(),e("#search").val(""),e("#search-reset").removeClass("open")}));var r={filters:e("#filters"),apply:e("#apply"),reset:e("#reset"),maploader:e(".map-loader"),loadmore:e(".load-more-btn"),maploadmore:e(".map-load-more-btn"),current_page:helper.current_page,max_page:helper.max_page};e(document).on("click","#apply",(function(){var a,t=e("#search").val();t.length>0&&e("#search-reset").addClass("open");var i=e("#price_min").val(),o=e("#price_max").val();if(e(".filter-size").length>0)var n=e("#size_min").val(),c=e("#size_max").val();else n="",c="";var p,d=e('input[name="agent"]').val();p=e('input[name="availability"]:checked').val()?e('input[name="availability"]:checked').val():e('input[name="availability"]').val();var m,u,v,f=e('.filter-status input[type="radio"]:checked').val();m=e('input[name="type"]:checked').val()?e('input[name="type"]:checked').val():e('input[name="type"]').val(),u=e('input[name="bed"]:checked').val()?e('input[name="bed"]:checked').val():e('input[name="bed"]').val(),v=e('input[name="bath"]:checked').val()?e('input[name="bath"]:checked').val():e('input[name="bath"]').val();var h=e(".filter-hood option:selected").val();a=[{key:"search",value:t},{key:"price_min",value:i},{key:"price_max",value:o},{key:"size_min",value:n},{key:"size_max",value:c},{key:"availability",value:p},{key:"type",value:m},{key:"status",value:f},{key:"bed",value:u},{key:"bath",value:v},{key:"hood",value:h},{key:"sort_by",value:k=e('#sorts input[type="radio"]:checked').attr("data-sort-by")},{key:"sort_order",value:_=e('#sorts input[type="radio"]:checked').attr("data-sort-order")}];var g,y,b=r.filters.serializeArray(),k=e('#sorts input[type="radio"]:checked').attr("data-sort-by"),_=e('#sorts input[type="radio"]:checked').attr("data-sort-order");b.push({name:"sort_by",value:k},{name:"sort_order",value:_},{name:"action",value:"seagrove_filter"});for(var x=new URL(window.location.href),C=x.search,w=new URLSearchParams(C),z=0;z<a.length;z++)g=a[z].key,y=a[z].value,w.has(g)?""!=y?w.set(g,y):w.delete(g):""!=y&&w.append(g,y);x.search=w.toString();var L=x.toString(),S={action:"seagrove_filter",security:helper.security_filter,search:t,price_min:i,price_max:o,size_min:n,size_max:c,agent:d,availability:p,status:f,type:m,bed:u,bath:v,hood:h,sort_by:k,sort_order:_};return e.ajax({url:helper.ajaxurl,data:S,type:"post",beforeSend:function(e){r.maploader.fadeIn("fast"),r.apply.text("Processing..."),console.log(S),console.log(r.current_page),console.log(r.max_page)},success:function(a){r.apply.text("Apply"),e("#listings").html(a),"undefined"!=typeof new_data&&""!==new_data&&(r.current_page=new_data.current_page,r.max_page=new_data.max_page),r.current_page<r.max_page?(r.loadmore.show().text("Load More"),r.maploadmore.show().text("Load More")):(r.loadmore.fadeOut("fast"),r.maploadmore.fadeOut("fast"))},complete:function(a){window.history.pushState({path:L},"",L),e("#map-filters").animate({scrollTop:0},250),e(".map-list").animate({scrollTop:0},250),e(".map-filters-container").removeClass("open"),e(".map-filter-btn").removeClass("active"),l(),s(locations),setTimeout((function(){r.maploader.fadeOut("fast")}),500)}}),!1})),e(document).on("click","#loadmore",(function(){var a,t=e("#search").val(),i=e("#price_min").val(),o=e("#price_max").val(),n=e("#size_min").val(),c=e("#size_max").val(),p=e('input[name="agent"]').val();a=e('input[name="availability"]:checked').val()?e('input[name="availability"]:checked').val():e('input[name="availability"]').val();var d,m,u,v=e('.filter-status input[type="radio"]:checked').val();d=e('input[name="type"]:checked').val()?e('input[name="type"]:checked').val():e('input[name="type"]').val(),m=e('input[name="bed"]:checked').val()?e('input[name="bed"]:checked').val():e('input[name="bed"]').val(),u=e('input[name="bath"]:checked').val()?e('input[name="bath"]:checked').val():e('input[name="bath"]').val();var f=e(".filter-hood option:selected").val(),h=e('#sorts input[type="radio"]:checked').attr("data-sort-by"),g=e('#sorts input[type="radio"]:checked').attr("data-sort-order"),y={action:"seagrove_loadmore",security:helper.security_load,locations,page:r.current_page,search:t,price_min:i,price_max:o,size_min:n,size_max:c,agent:p,availability:a,status:v,type:d,bed:m,bath:u,hood:f,sort_by:h,sort_order:g};e.ajax({url:helper.ajaxurl,data:y,type:"POST",beforeSend:function(e){r.maploader.fadeIn("fast"),r.loadmore.text("Loading..."),r.maploadmore.text("Loading..."),console.log(y),console.log(r.current_page),console.log(r.max_page)},success:function(a){if(a){var t=e(a);e("#listings").append(t),r.current_page++,r.current_page==r.max_page?(r.loadmore.fadeOut("fast"),r.maploadmore.fadeOut("fast")):(r.loadmore.text("Load More"),r.maploadmore.text("Load More"))}else r.loadmore.remove(),r.maploadmore.remove()},complete:function(e){l(),s(locations),setTimeout((function(){r.maploader.fadeOut("fast")}),500)}})})),e(document).on("click","#reset",(function(a){a.preventDefault(),e("#search").val(""),e("#search-reset").removeClass("open"),e("#price_min").val(""),e("#price_max").val(""),e("#size_min").val(""),e("#size_max").val("");var t=e('input[name="agent"]').val();if(e(".filter-availability").length>0)e('.filter-availability input[type="radio"]:first').prop("checked",!0),e(".filter-availability .button").removeClass("checked"),e(".filter-availability .button:first").addClass("checked");else var i=e('input[name="availability"]').val();if(e('.filter-status input[type="radio"]:first').prop("checked",!0),e(".filter-status .button").removeClass("checked"),e(".filter-status .button:first").addClass("checked"),e(".filter-type").length>0){e('.filter-type input[type="radio"]:first').prop("checked",!0),e(".filter-type .button").removeClass("checked"),e(".filter-type .button:first").addClass("checked");var o=e('input[name="type"]').val()}else o=e('input[name="type"]').val();e('.filter-beds input[type="radio"]:first').prop("checked",!0),e('.filter-bath input[type="radio"]:first').prop("checked",!0),e(".filter-hood option:first").prop("selected",!0),e('#sorts input[type="radio"]:first').prop("checked",!0);var n={action:"seagrove_filter",security:helper.security_filter,agent:t,availability:i,type:o};return e.ajax({url:helper.ajaxurl,data:n,type:"post",beforeSend:function(e){r.maploader.fadeIn("fast"),r.reset.text("Processing..."),console.log(n)},success:function(a){r.reset.text("Reset all"),e("#listings").html(a),"undefined"!=typeof new_data&&(r.current_page=new_data.current_page,r.max_page=new_data.max_page),r.current_page<r.max_page?(r.loadmore.show().text("Load More"),r.maploadmore.show().text("Load More")):(r.loadmore.fadeOut("fast"),r.maploadmore.fadeOut("fast"))},complete:function(a){window.history.replaceState({},"",location.pathname),e("#map-filters").animate({scrollTop:0},250),e(".map-list").animate({scrollTop:0},250),e(".map-filters-container").removeClass("open"),e(".map-filter-btn").removeClass("active"),l(),s(locations),setTimeout((function(){r.maploader.fadeOut("fast")}),500)}}),!1}))}})),e(".map-list-controls a").click((function(a){a.preventDefault(),e(this).hasClass("active")?(e(this).removeClass("active"),e(this).siblings().addClass("active")):(e(this).addClass("active"),e(this).siblings().removeClass("active")),e(".map-list-controls .show-list").hasClass("active")?e(".map-list").addClass("open"):e(".map-list").removeClass("open")})),e(".map-filter-btn").click((function(a){a.preventDefault(),e(this).toggleClass("active"),e(".map-filters-container").toggleClass("open")})),e(".close-filter-btn").click((function(a){a.preventDefault(),e(".map-filter-btn").removeClass("active"),e(".map-filters-container").removeClass("open")})),e('.buttons .button input[type="radio"]').click((function(){e(this).closest(".button").siblings().removeClass("checked"),e(this).closest(".button").addClass("checked")}))}));